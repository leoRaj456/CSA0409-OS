#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct emp {
    int id;
    char name[20];
    float salary;
};

int main() {
    FILE *fp;
    struct emp e;
    int ch, id, found;
    long pos;

    fp = fopen("emp.dat", "rb+");
    if (!fp) fp = fopen("emp.dat", "wb+");

    while (1) {
        printf("\n1.Add 2.Display 3.Search 4.Modify 5.Exit\nEnter choice: ");
        scanf("%d", &ch);
        switch (ch) {
        case 1:
            printf("Enter ID Name Salary: ");
            scanf("%d %s %f", &e.id, e.name, &e.salary);
            fseek(fp, 0, SEEK_END);
            fwrite(&e, sizeof(e), 1, fp);
            break;
        case 2:
            rewind(fp);
            printf("\nID\tName\tSalary\n");
            while (fread(&e, sizeof(e), 1, fp))
                printf("%d\t%s\t%.2f\n", e.id, e.name, e.salary);
            break;
        case 3:
            printf("Enter ID: ");
            scanf("%d", &id);
            rewind(fp);
            found = 0;
            while (fread(&e, sizeof(e), 1, fp))
                if (e.id == id) { printf("Found: %s %.2f\n", e.name, e.salary); found = 1; break; }
            if (!found) printf("Not found!\n");
            break;
        case 4:
            printf("Enter ID to modify: ");
            scanf("%d", &id);
            rewind(fp);
            while (fread(&e, sizeof(e), 1, fp))
                if (e.id == id) {
                    printf("Enter new salary: ");
                    scanf("%f", &e.salary);
                    pos = ftell(fp) - sizeof(e);
                    fseek(fp, pos, SEEK_SET);
                    fwrite(&e, sizeof(e), 1, fp);
                    printf("Updated.\n");
                    break;
                }
            break;
        case 5:
            fclose(fp);
            exit(0);
        }
    }
}
